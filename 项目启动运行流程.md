# 智能餐饮服务系统 - 项目启动运行流程

> **📌 快速开始：** 如果您是第一次运行，建议先查看 [完整运行指南.md](./完整运行指南.md)，那里有更详细的步骤说明。

## 一、环境准备

### 1.1 必需软件（按项目要求配置）
- **JDK 17** （必须）
- **Maven 3.9** （必须）
- **Node.js 10.9** （必须）
- **MySQL 8.0** （必须）
- **Redis** （必须，用于缓存优化）

### 1.2 开发工具
- **IntelliJ IDEA** （推荐，后端开发）
- **Navicat** （数据库管理工具）
- **VS Code** 或 **WebStorm**（前端开发，可选）

### 1.3 默认配置信息
- **数据库**: root / 123456
- **管理员账号**: admin / 123456
- **后台访问地址**: http://localhost:8080/
- **后端API地址**: http://localhost:8088

## 二、数据库配置

### 2.1 快速导入（推荐方式）
项目根目录提供了完整的数据库SQL文件：`database.sql`

**Windows系统：**
```bash
# 方式1：使用命令行（数据库密码：123456）
mysql -u root -p123456 < database.sql

# 方式2：使用Navicat
# 1. 打开Navicat，连接到MySQL服务器（root/123456）
# 2. 右键数据库 -> 运行SQL文件
# 3. 选择 database.sql 文件并执行
```

**Linux/Mac系统：**
```bash
mysql -u root -p123456 < database.sql
```

### 2.2 手动创建数据库
如果选择手动创建，执行以下SQL：
```sql
CREATE DATABASE orderfoodapp CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 2.3 数据库表结构说明
`database.sql` 文件包含完整的数据库表结构，主要包括以下表：

**核心表：**
- `food` - 菜品表
- `t_order` - 订单表
- `t_order_details` - 订单详情表
- `sys_user` - 用户表
- `type` - 分类表
- `tag` - 标签表
- `seat` - 座位表
- `comment` - 评价表

**新增智能功能表：**
- `member_level` - 会员等级表
- `member` - 会员信息表
- `coupon` - 优惠券表
- `user_coupon` - 用户优惠券表
- `queue_number` - 排号表
- `food_popularity` - 菜品热度统计表

**核心业务表：**
- `food` - 菜品表
- `t_order` - 订单表
- `t_order_details` - 订单详情表
- `sys_user` - 用户表
- `type` - 分类表
- `tag` - 标签表
- `seat` - 座位表
- `comment` - 评价表
- `food_tag` - 菜品标签关联表
- `food_pricutre` - 菜品图片表
- `food_food` - 菜品配料关联表

**权限管理表：**
- `sys_role` - 角色表
- `sys_menu` - 菜单表
- `sys_user_role` - 用户角色关联表
- `sys_role_menu` - 角色菜单关联表

**智能功能表：**
- `member_level` - 会员等级表
- `member` - 会员信息表
- `coupon` - 优惠券表
- `user_coupon` - 用户优惠券表
- `queue_number` - 排号表
- `food_popularity` - 菜品热度统计表

**注意：** `database.sql` 文件已经包含了所有表的完整创建语句、索引、初始数据和存储过程，直接导入即可使用。

## 三、后端服务启动（order_food）

### 3.1 配置数据库连接
编辑文件：`order_food/xlf_main/src/main/resources/application-dev.yaml`

**重要：配置文件已预设为：**
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/orderfoodapp?characterEncoding=utf-8&serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true
    username: root
    password: 123456  # 默认密码
    driver-class-name: com.mysql.cj.jdbc.Driver
  redis:
    host: localhost
    port: 6379
    password:  # Redis密码（如无密码则留空）
    database: 0
```

**已配置项：**
- ✅ 数据库用户名/密码：root/123456
- ✅ Redis配置（默认localhost:6379）
- ✅ 微信小程序配置（AppID和Secret已配置）
- ✅ 百度AI配置（情感分析API已配置）

### 3.2 编译项目
在项目根目录 `orderFoodAppPublic-master` 下执行：

```bash
cd order_food
mvn clean install
```

### 3.3 启动后端服务
方式一：使用IDE启动
- 打开 `order_food/xlf_main/src/main/java/com/xlf/Xlf_main.java`
- 运行 `main` 方法

方式二：使用Maven命令启动
```bash
cd order_food/xlf_main
mvn spring-boot:run
```

方式三：打包后启动
```bash
cd order_food/xlf_main
mvn clean package
java -jar target/xlf_main-1.0-SNAPSHOT.jar
```

### 3.4 验证后端启动
后端服务默认启动在：`http://localhost:8088`

**启动成功标志：**
- 控制台显示：`智能餐饮服务系统启动成功！`
- 控制台显示：`后端服务地址: http://localhost:8088`
- 无错误日志

**注意事项：**
- 确保MySQL服务已启动（root/123456）
- 确保Redis服务已启动（默认端口6379）
- 如Redis未安装，可先注释掉Redis相关配置

## 四、管理后台启动（order_food_vue_admin）

### 4.1 安装依赖
```bash
cd order_food_vue_admin
npm install
```

### 4.2 配置API地址
编辑文件：`order_food_vue_admin/src/utils/request.js`

确认 `baseURL` 配置正确：
```javascript
baseURL: '/api'  // 开发环境需要配置代理
```

### 4.3 配置开发代理（vue.config.js）
确保 `vue.config.js` 中配置了正确的代理：

```javascript
module.exports = {
  devServer: {
    proxy: {
      '/api': {
        target: 'http://localhost:8088',
        changeOrigin: true,
        pathRewrite: {
          '^/api': '/api'
        }
      }
    }
  }
}
```

### 4.4 启动开发服务器
```bash
npm run serve
```

### 4.5 访问管理后台
浏览器访问：`http://localhost:8080`

**默认登录信息：**
- 账号：admin
- 密码：123456

**注意：** 前端开发服务器会自动打开浏览器

## 五、移动端启动（orderFoodApp）

### 5.1 安装依赖
```bash
cd orderFoodApp
npm install
```

### 5.2 配置API地址
编辑 `orderFoodApp/utils/request.js`，配置后端API地址

### 5.3 运行到微信小程序
```bash
# 使用HBuilderX打开项目
# 或使用uni-app CLI
npm run dev:mp-weixin
```

### 5.4 在微信开发者工具中打开
1. 打开微信开发者工具
2. 导入项目，选择 `orderFoodApp/unpackage/dist/dev/mp-weixin` 目录
3. 配置小程序AppID（需要申请）

## 六、功能验证

### 6.1 后端API测试
使用Postman或浏览器测试以下接口：

**智能推荐接口：**
- `GET /api/client/recommendation/popular?limit=10` - 获取热门菜品
- `GET /api/client/recommendation/personalized?userId=1&limit=10` - 个性化推荐

**数据分析接口：**
- `GET /api/admin/analytics/dashboard` - 数据大屏
- `GET /api/admin/analytics/sales?startDate=2024-01-01&endDate=2024-12-31` - 销售统计

### 6.2 管理后台功能测试
1. 登录管理后台
2. 访问数据分析页面：`/analytics`
3. 访问数据大屏：`/dashboard`

### 6.3 移动端功能测试
1. 打开微信小程序
2. 测试菜品浏览和下单功能
3. 测试智能推荐功能

## 七、常见问题排查

### 7.1 后端启动失败
- **问题**：数据库连接失败
- **解决**：检查 `application-dev.yaml` 中的数据库配置
  - 确认MySQL服务已启动
  - 确认用户名密码为 root/123456
  - 确认数据库 `orderfoodapp` 已创建

- **问题**：Redis连接失败
- **解决**：
  - 确认Redis服务已启动（默认端口6379）
  - 如未安装Redis，可临时注释掉Redis配置
  - Windows安装Redis：下载Redis for Windows或使用WSL

- **问题**：端口被占用
- **解决**：修改 `application-dev.yaml` 中的 `server.port`

- **问题**：JDK版本不匹配
- **解决**：确认JDK版本为17，在IDEA中设置Project SDK为17

### 7.2 前端启动失败
- **问题**：npm install 失败
- **解决**：清除缓存后重新安装
  ```bash
  rm -rf node_modules package-lock.json
  npm install
  ```
  **注意**：Node.js版本要求10.9，如版本不匹配可能导致安装失败

- **问题**：API请求失败
- **解决**：
  - 检查 `vue.config.js` 中的代理配置
  - 确认后端服务已启动（http://localhost:8088）
  - 检查浏览器控制台错误信息

- **问题**：端口8080被占用
- **解决**：修改 `vue.config.js` 中的 `devServer.port`

### 7.3 数据库问题
- **问题**：表不存在
- **解决**：执行数据库建表SQL语句

## 八、项目结构说明

```
orderFoodAppPublic-master/
├── order_food/                 # 后端服务（Spring Boot）
│   ├── commons/               # 公共模块
│   └── xlf_main/              # 主应用模块
│       └── src/main/java/com/xlf/
│           ├── controller/    # 控制器层
│           │   ├── admin/     # 管理端接口
│           │   └── client/    # 客户端接口
│           ├── service/       # 服务层
│           ├── domain/        # 实体类
│           ├── mapper/        # 数据访问层
│           └── vo/            # 视图对象
├── order_food_vue_admin/      # 管理后台（Vue 2 + Element UI）
│   └── src/
│       ├── api/              # API接口
│       ├── views/            # 页面组件
│       └── router/           # 路由配置
└── orderFoodApp/             # 移动端（uni-app）
    ├── pages/               # 页面
    └── api/                 # API接口
```

## 九、智能功能说明

### 9.1 已实现的智能功能
1. **智能推荐系统**
   - 基于用户行为的个性化推荐
   - 热门菜品推荐
   - 相似菜品推荐
   - 菜品热度统计

2. **数据分析与报表**
   - 销售数据统计
   - 菜品销售排行
   - 用户行为分析
   - 营业额趋势分析
   - 实时数据大屏

3. **情感分析系统**（新增）
   - 集成百度AI情感分析API
   - 评论情感识别
   - 顾客情绪分析
   - 服务质量评估

4. **Redis缓存优化**（新增）
   - 菜品信息缓存
   - 用户会话缓存
   - 推荐结果缓存

5. **会员管理系统**（实体已创建）
   - 会员等级管理
   - 积分系统

6. **优惠券系统**（实体已创建）
   - 优惠券管理
   - 用户优惠券管理

7. **排号叫号系统**（实体已创建）
   - 在线排队取号
   - 排队状态管理

### 9.2 核心API接口

**智能推荐：**
- `GET /api/client/recommendation/popular?limit=10` - 获取热门菜品
- `GET /api/client/recommendation/personalized?userId=1&limit=10` - 个性化推荐

**情感分析：**
- `POST /api/admin/sentiment/analyze?text=菜品很好吃` - 文本情感分析

**数据分析：**
- `GET /api/admin/analytics/dashboard` - 数据大屏
- `GET /api/admin/analytics/sales` - 销售统计

### 9.3 配置说明

**微信小程序配置：**
- AppID: wxdf52547718b4b8ff
- AppSecret: bf601e9a0c6cf7248bb5c3a65a4cf619

**百度AI配置：**
- AppID: 120413675
- API Key: 4xDFiMDaQY5GC0EDv6YeNUpH
- Secret Key: AsYkEqatcEfYzSBzXvAeA5IK7oXhnaq1

### 9.4 待完善功能
- 语音点餐功能集成
- 扫码点餐完整流程
- 订单智能排序算法优化
- 出餐时间预测模型
- 库存预警自动提醒
- 移动端智能推荐UI优化

## 十、后续开发建议

1. **完善业务逻辑**：实现会员、优惠券、排号等模块的完整业务逻辑
2. **优化推荐算法**：使用更复杂的推荐算法（协同过滤、内容推荐等）
3. **数据可视化**：使用ECharts等工具增强数据可视化效果
4. **性能优化**：添加Redis缓存、数据库索引优化等
5. **安全加固**：完善权限控制、数据加密等安全措施

## 十一、技术支持

如遇到问题，请检查：
1. 日志文件：查看控制台输出和日志文件
2. 数据库：确认数据库连接和表结构正确
3. 配置文件：检查各配置文件是否正确
4. 网络：确认前后端通信正常

---

**祝使用愉快！**

